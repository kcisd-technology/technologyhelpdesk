-level ||= 0
-max_level ||= 5
-divider ||= 'comments/comments_divider'
-indent ||= 15
-show_children ||= true
-add_css_files 'comments'
-add_js_files 'effects', 'comment_scripts'
.comment{:style=>"margin-left:#{indent}px"}
  =comment.user.gravatar(:size => 60, :options => {:style=> 'float:left;margin-right:5px'})
  %div
    ="#{comment.user.login} said on #{comment.created_at.strftime("%d %b %Y %I:%M%p")}"
    %br/
    %i= "Last Updated: #{comment.updated_at.strftime("%d %b %Y %I:%M%p")}"
  -if comment.full_control_by_current_user?
    .controls
      =link_to 'Edit', edit_comment_path(comment)
      |
      =link_to 'Destroy', comment, :confirm => 'Are you sure?', :method => :delete
      -if max_level > 1 && show_children
        |
        =link_to "Reply to this comment", new_comment_path(:parent_id => comment.id, :parent_type => "Comment")
  .body
    .content= RedCloth.new(Liquid::Template.parse(comment.body).render('parent_object' => comment.top_commentable)).to_html
    -if max_level > 1 && !comment.comments.empty? && show_children
      .children= render_comments(comment, max_level - 1, level + 1, divider);